C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <stc12c5a60s2.h>
   2          
   3          #define uchar unsigned char
   4          #define uint unsigned int
   5          
   6          #define LongToBin(n) (((n>>21)&0x80)|((n>>18)&0x40)|((n>>15)&0x20)|((n>>12)&0x10)|((n>>9)&0x08)|((n>>6)&0x
             -04)|((n>>3)&0x02)|((n)&0x01))
   7          #define BIN(n) LongToBin(0x##n##)
   8          
   9          sbit anjian=P4^5;
  10          
  11          sbit P0_0=P0^0;//层
  12          sbit P0_1=P0^1;
  13          sbit P0_2=P0^2;
  14          sbit P0_3=P0^3;
  15          sbit P0_4=P0^4;
  16          sbit P0_5=P0^5;
  17          sbit P0_6=P0^6;
  18          sbit P0_7=P0^7;
  19          sbit P4_6=P4^6;
  20          sbit P1_1=P1^1;
  21          sbit P1_2=P1^2;
  22          sbit P1_3=P1^3;
  23          sbit P1_4=P1^4;
  24          sbit P1_5=P1^5;
  25          sbit P1_6=P1^6;
  26          sbit P1_7=P1^7;
  27          
  28          sbit P3_0=P3^0;//竖
  29          sbit P3_1=P3^1;
  30          sbit P3_2=P3^2;
  31          sbit P3_3=P3^3;
  32          sbit P3_4=P3^4;
  33          sbit P3_5=P3^5;
  34          sbit P3_6=P3^6;
  35          sbit P3_7=P3^7;
  36          sbit P2_0=P2^0;
  37          sbit P2_1=P2^1;
  38          sbit P2_2=P2^2;
  39          sbit P2_3=P2^3;
  40          sbit P2_4=P2^4;
  41          sbit P2_5=P2^5;
  42          sbit P2_6=P2^6;
  43          sbit P2_7=P2^7;
  44          sbit P4_4=P4^4;
  45          
  46          char moshi=1;
  47          char h=0,v=0;
  48          int t=0;
  49          char zy=0,sj=0,jz=0;
  50          
  51          bit ly_flag=0;                                                          //成功接收标志
  52          
  53          void delay_1ms(uint q)
  54          {
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 2   

  55   1              uint i,j;
  56   1              for(i=0;i<q;i++)
  57   1                      for(j=0;j<110;j++);
  58   1      } 
  59          void key()
  60          {
  61   1              if(anjian==0)
  62   1              {
  63   2                      delay_1ms(5);
  64   2                      if(anjian==0)
  65   2                      {
  66   3                              while(anjian==0);
  67   3                              jz++;
  68   3                              if(jz==2)jz=0;
  69   3                              if(jz==0){moshi=1;TR0=0;ET0=0;};
  70   3                              if(jz==1){moshi=0;ly_flag=1;TR0=1;ET0=1;}
  71   3                      }       
  72   2              }
  73   1      }
  74          void dh1()
  75          {
  76   1              char i,j;
  77   1              P3_0=0;//J1
  78   1              P3_1=0;//J2
  79   1              P3_3=0;//J3
  80   1              P3_4=0;//J4
  81   1              P3_5=0;//J5
  82   1              P3_6=0;//J6
  83   1              P3_7=0;//J7
  84   1              P2_0=0;//J8
  85   1              P2_1=0;//J9
  86   1              P2_2=0;//J10
  87   1              P2_3=0;//J11
  88   1              P2_4=0;//J12
  89   1              P2_5=0;//J13
  90   1              P2_6=0;//J14
  91   1              P2_7=0;//J15
  92   1              P4_4=0;//J16
  93   1              
  94   1              P1_7=0;
  95   1              P1_6=0;
  96   1              P1_5=0;
  97   1              P1_4=0;
  98   1              P1_3=0;
  99   1              P1_2=0;
 100   1              P1_1=0;
 101   1      
 102   1              P4_6=0;
 103   1      
 104   1              P0=0X01;
 105   1              delay_1ms(10);
 106   1              for(j=0;j<7;j++)
 107   1              {
 108   2                      P0=(P0<<1)|0x01;
 109   2                      delay_1ms(10);
 110   2              }
 111   1              P4_6=1;
 112   1              delay_1ms(10);  
 113   1              P1_1=1;
 114   1              delay_1ms(10);
 115   1              P1_2=1;
 116   1              delay_1ms(10);
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 3   

 117   1              P1_3=1;
 118   1              delay_1ms(10);
 119   1              P1_4=1;
 120   1              delay_1ms(10);
 121   1              P1_5=1;
 122   1              delay_1ms(10);
 123   1              P1_6=1;
 124   1              delay_1ms(10);
 125   1              P1_7=1; 
 126   1      
 127   1              for(i=0;i<2;i++)
 128   1              {
 129   2                      P1_7=0;
 130   2                      P1_6=0;
 131   2                      P1_5=0;
 132   2                      P1_4=0;
 133   2                      P1_3=0;
 134   2                      P1_2=0;
 135   2                      P1_1=0;
 136   2              
 137   2                      P4_6=0;
 138   2              
 139   2                      P0=0X01;
 140   2                      delay_1ms(1000);
 141   2                      for(j=0;j<7;j++)
 142   2                      {
 143   3                              P0=(P0<<1)|0x01;
 144   3                              delay_1ms(700);
 145   3                              key();
 146   3                              if(ly_flag==1){ly_flag=0;break;}
 147   3                      }
 148   2              
 149   2                      P4_6=1;
 150   2                      delay_1ms(700);
 151   2                      key();
 152   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}        
 153   2                      P1_1=1;
 154   2                      delay_1ms(700);
 155   2                      key();
 156   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 157   2                      P1_2=1;
 158   2                      delay_1ms(700);
 159   2                      key();
 160   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 161   2                      P1_3=1;
 162   2                      delay_1ms(700);
 163   2                      key();
 164   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 165   2                      P1_4=1;
 166   2                      delay_1ms(700);
 167   2                      key();
 168   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 169   2                      P1_5=1;
 170   2                      delay_1ms(700);
 171   2                      key();
 172   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 173   2                      P1_6=1;
 174   2                      delay_1ms(700);
 175   2                      key();
 176   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 177   2                      P1_7=1;
 178   2                      delay_1ms(8000);
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 4   

 179   2                      key();
 180   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 181   2                      delay_1ms(8000);
 182   2                      key();
 183   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 184   2                      delay_1ms(8000);
 185   2                      key();
 186   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 187   2                      delay_1ms(8000);
 188   2                      key();
 189   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 190   2                      delay_1ms(8000);
 191   2                      key();
 192   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 193   2                      delay_1ms(8000);
 194   2                      key();                  
 195   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 196   2              }                               
 197   1      }
 198          void dh2()
 199          {
 200   1              char j;
 201   1              P1_7=1;
 202   1              P1_6=1;
 203   1              P1_5=1;
 204   1              P1_4=1;
 205   1              P1_3=1;
 206   1              P1_2=1;
 207   1              P1_1=1;
 208   1      
 209   1              P4_6=1;
 210   1      
 211   1              P0_7=1;
 212   1              P0_6=1;
 213   1              P0_5=1;
 214   1              P0_4=1;
 215   1              P0_3=1;
 216   1              P0_2=1;
 217   1              P0_1=1;
 218   1              P0_0=1;
 219   1      
 220   1              for(j=0;j<12;j++)
 221   1              {
 222   2                      P4_4=1;
 223   2                      P2_0=1;
 224   2                      P3_0=0;
 225   2                      P2_1=0;
 226   2                      delay_1ms(400);
 227   2              
 228   2                      P3_0=1;
 229   2                      P2_1=1;
 230   2                      P3_1=0;
 231   2                      P2_2=0;
 232   2                      delay_1ms(400);
 233   2              
 234   2                      P3_1=1;
 235   2                      P2_2=1;
 236   2                      P3_3=0;
 237   2                      P2_3=0;
 238   2                      delay_1ms(400);
 239   2                      key();
 240   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}        
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 5   

 241   2                      P3_3=1;
 242   2                      P2_3=1;
 243   2                      P3_4=0;
 244   2                      P2_4=0;
 245   2                      delay_1ms(400);
 246   2              
 247   2                      P3_4=1;
 248   2                      P2_4=1;
 249   2                      P3_5=0;
 250   2                      P2_5=0;
 251   2                      delay_1ms(400);
 252   2              
 253   2                      P3_5=1;
 254   2                      P2_5=1;
 255   2                      P3_6=0;
 256   2                      P2_6=0;
 257   2                      delay_1ms(400);
 258   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}        
 259   2                      P3_6=1;
 260   2                      P2_6=1;
 261   2                      P3_7=0;
 262   2                      P2_7=0;
 263   2                      delay_1ms(400);
 264   2              
 265   2                      P3_7=1;
 266   2                      P2_7=1;
 267   2                      P4_4=0;
 268   2                      P2_0=0;
 269   2                      delay_1ms(400); 
 270   2                      key();
 271   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 272   2              }
 273   1      }
 274          void dh3()
 275          {
 276   1              char i,j;
 277   1              int yanshi=400;
 278   1              P3_0=0;//J1
 279   1              P3_1=0;//J2
 280   1              P3_3=0;//J3
 281   1              P3_4=0;//J4
 282   1              P3_5=0;//J5
 283   1              P3_6=0;//J6
 284   1              P3_7=0;//J7
 285   1              P2_0=0;//J8
 286   1              P2_1=0;//J9
 287   1              P2_2=0;//J10
 288   1              P2_3=0;//J11
 289   1              P2_4=0;//J12
 290   1              P2_5=0;//J13
 291   1              P2_6=0;//J14
 292   1              P2_7=0;//J15
 293   1              P4_4=0;//J16
 294   1      
 295   1              for(i=0;i<3;i++)
 296   1              {
 297   2                      P1_7=0;
 298   2                      P1_6=0;
 299   2                      P1_5=0;
 300   2                      P1_4=0;
 301   2                      P1_3=0;
 302   2                      P1_2=0;
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 6   

 303   2                      P1_1=0;
 304   2              
 305   2                      P4_6=0;
 306   2              
 307   2                      P0=0X01;
 308   2                      delay_1ms(yanshi);
 309   2                      for(j=0;j<7;j++)
 310   2                      {
 311   3                              P0=(P0<<1);
 312   3                              delay_1ms(yanshi);
 313   3                              key();
 314   3                              if(ly_flag==1){moshi=0;ly_flag=0;break;}
 315   3                      }
 316   2              
 317   2                      P0_7=0; 
 318   2                      P4_6=1;
 319   2                      delay_1ms(yanshi);
 320   2              
 321   2                      P4_6=0; 
 322   2                      P1_1=1;
 323   2                      delay_1ms(yanshi);
 324   2              
 325   2                      P1_1=0; 
 326   2                      P1_2=1;
 327   2                      delay_1ms(yanshi);
 328   2                      key();
 329   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 330   2                      P1_2=0;         
 331   2                      P1_3=1;
 332   2                      delay_1ms(yanshi);
 333   2              
 334   2                      P1_3=0;         
 335   2                      P1_4=1;
 336   2                      delay_1ms(yanshi);
 337   2              
 338   2                      P1_4=0;         
 339   2                      P1_5=1;
 340   2                      delay_1ms(yanshi);
 341   2                      key();
 342   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 343   2                      P1_5=0;         
 344   2                      P1_6=1;
 345   2                      delay_1ms(yanshi);
 346   2              
 347   2                      P1_6=0;         
 348   2                      P1_7=1;
 349   2                      delay_1ms(yanshi);
 350   2              
 351   2                      P1_6=1;         
 352   2                      P1_7=0;
 353   2                      delay_1ms(yanshi);
 354   2                      key();
 355   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 356   2                      P1_5=1;         
 357   2                      P1_6=0;
 358   2                      delay_1ms(yanshi);
 359   2              
 360   2                      P1_4=1;         
 361   2                      P1_5=0;
 362   2                      delay_1ms(yanshi);
 363   2              
 364   2                      P1_3=1;         
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 7   

 365   2                      P1_4=0;
 366   2                      delay_1ms(yanshi);
 367   2                      key();
 368   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 369   2                      P1_2=1;         
 370   2                      P1_3=0;
 371   2                      delay_1ms(yanshi);
 372   2              
 373   2                      P1_1=1;         
 374   2                      P1_2=0;
 375   2                      delay_1ms(yanshi);
 376   2              
 377   2                      P1_1=0;         
 378   2                      P0_7=1;
 379   2                      delay_1ms(yanshi);
 380   2                      key();
 381   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 382   2                      P0_6=1;         
 383   2                      P0_7=0;
 384   2                      delay_1ms(yanshi);
 385   2              
 386   2                      P0_5=1;         
 387   2                      P0_6=0;
 388   2                      delay_1ms(yanshi);
 389   2              
 390   2                      P0_4=1;         
 391   2                      P0_5=0;
 392   2                      delay_1ms(yanshi);
 393   2                      key();
 394   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 395   2                      P0_3=1;         
 396   2                      P0_4=0;
 397   2                      delay_1ms(yanshi);
 398   2              
 399   2                      P0_2=1;         
 400   2                      P0_3=0;
 401   2                      delay_1ms(yanshi);
 402   2              
 403   2                      P0_1=1;         
 404   2                      P0_2=0;
 405   2                      delay_1ms(yanshi);
 406   2                      key();
 407   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 408   2              }
 409   1      }
 410          void dh4()
 411          {
 412   1              char j;
 413   1              P3_0=0;//J1
 414   1              P3_1=0;//J2
 415   1              P3_3=0;//J3
 416   1              P3_4=0;//J4
 417   1              P3_5=0;//J5
 418   1              P3_6=0;//J6
 419   1              P3_7=0;//J7
 420   1              P2_0=0;//J8
 421   1              P2_1=0;//J9
 422   1              P2_2=0;//J10
 423   1              P2_3=0;//J11
 424   1              P2_4=0;//J12
 425   1              P2_5=0;//J13
 426   1              P2_6=0;//J14
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 8   

 427   1              P2_7=0;//J15
 428   1              P4_4=0;//J16
 429   1              
 430   1              P1_7=0;
 431   1              P1_6=0;
 432   1              P1_5=0;
 433   1              P1_4=0;
 434   1              P1_3=0;
 435   1              P1_2=0;
 436   1              P1_1=0;
 437   1              P4_6=0;
 438   1              P0_7=0;
 439   1              P0_6=0;
 440   1              P0_5=0;
 441   1              P0_4=0;
 442   1              P0_3=0;
 443   1              P0_2=0;
 444   1              P0_1=0;
 445   1              P0_1=0; 
 446   1              P0_0=0; 
 447   1              for(j=0;j<3;j++)
 448   1              {
 449   2                      P1_7=0;
 450   2                      P0_0=0;         
 451   2                      P4_6=1;
 452   2                      P0_7=1; 
 453   2                      delay_1ms(500);
 454   2                      
 455   2                      P4_6=0;
 456   2                      P0_7=0; 
 457   2                      P1_1=1;
 458   2                      P0_6=1;
 459   2                      delay_1ms(500);
 460   2                      key();
 461   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 462   2                      P1_2=1;
 463   2                      P0_5=1; 
 464   2                      P1_1=0;
 465   2                      P0_6=0;
 466   2                      delay_1ms(500);
 467   2                      
 468   2                      P1_3=1;
 469   2                      P0_4=1; 
 470   2                      P1_2=0;
 471   2                      P0_5=0;
 472   2                      delay_1ms(500);
 473   2                      key();
 474   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 475   2                      P1_4=1;
 476   2                      P0_3=1; 
 477   2                      P1_3=0;
 478   2                      P0_4=0;
 479   2                      delay_1ms(500);
 480   2                      
 481   2                      P1_5=1;
 482   2                      P0_2=1; 
 483   2                      P1_4=0;
 484   2                      P0_3=0;
 485   2                      delay_1ms(500);
 486   2                      key();
 487   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 488   2                      P1_6=1;
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 9   

 489   2                      P0_1=1; 
 490   2                      P1_5=0;
 491   2                      P0_2=0;
 492   2                      delay_1ms(500);
 493   2                      
 494   2                      P1_7=1;
 495   2                      P0_0=1; 
 496   2                      P1_6=0;
 497   2                      P0_1=0;
 498   2                      delay_1ms(500); 
 499   2                      key();
 500   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 501   2              }                               
 502   1      }
 503          void dh5()
 504          {
 505   1              char i;
 506   1              P1_7=1;
 507   1              P1_6=1;
 508   1              P1_5=1;
 509   1              P1_4=1;
 510   1              P1_3=1;
 511   1              P1_2=1;
 512   1              P1_1=1;
 513   1              P4_6=1;
 514   1              P0_7=1;
 515   1              P0_6=1;
 516   1              P0_5=1;
 517   1              P0_4=1;
 518   1              P0_3=1;
 519   1              P0_2=1;
 520   1              P0_1=1;
 521   1              P0_1=1; 
 522   1              P0_0=1;
 523   1              
 524   1              for(i=0;i<3;i++)
 525   1              {
 526   2                      P3_0=0; 
 527   2                      delay_1ms(400); 
 528   2                      P3_1=0; 
 529   2                      delay_1ms(400); 
 530   2                      P3_3=0; 
 531   2                      delay_1ms(400); 
 532   2                      P3_4=0; 
 533   2                      delay_1ms(400); 
 534   2                      key();
 535   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 536   2                      P3_5=0; 
 537   2                      delay_1ms(400); 
 538   2                      P3_6=0; 
 539   2                      delay_1ms(400); 
 540   2                      P3_7=0; 
 541   2                      delay_1ms(400);         
 542   2                      P2_0=0; 
 543   2                      delay_1ms(400); 
 544   2                      key();
 545   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 546   2                      P2_1=0; 
 547   2                      delay_1ms(400); 
 548   2                      P2_2=0; 
 549   2                      delay_1ms(400); 
 550   2                      P2_3=0; 
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 10  

 551   2                      delay_1ms(400); 
 552   2                      P2_4=0; 
 553   2                      delay_1ms(400);
 554   2                      key();
 555   2                      if(ly_flag==1){moshi=0;break;}  
 556   2                      P2_5=0; 
 557   2                      delay_1ms(400); 
 558   2                      P2_6=0; 
 559   2                      delay_1ms(400); 
 560   2                      P2_7=0; 
 561   2                      delay_1ms(400); 
 562   2                      P4_4=0; 
 563   2                      delay_1ms(9000);
 564   2                      key();
 565   2                      if(ly_flag==1){moshi=0;break;}
 566   2                      delay_1ms(9000);
 567   2                      key();
 568   2                      if(ly_flag==1){moshi=0;break;}
 569   2                      delay_1ms(9000);
 570   2                      key();
 571   2                      if(ly_flag==1){moshi=0;break;}          
 572   2                      P2=0XFF;
 573   2                      P3=0XFF;
 574   2                      P4_4=1;         
 575   2              }                       
 576   1      }
 577          void dh6()
 578          {
 579   1              char j;
 580   1              int yanshi=3000;
 581   1              P1_7=1;
 582   1              P1_6=1;
 583   1              P1_5=1;
 584   1              P1_4=1;
 585   1              P1_3=1;
 586   1              P1_2=1;
 587   1              P1_1=1;
 588   1      
 589   1              P4_6=1;
 590   1      
 591   1              P0_7=1;
 592   1              P0_6=1;
 593   1              P0_5=1;
 594   1              P0_4=1;
 595   1              P0_3=1;
 596   1              P0_2=1;
 597   1              P0_1=1;
 598   1              P0_0=1;
 599   1      
 600   1              for(j=0;j<20;j++)
 601   1              {
 602   2                      P3_4=1;
 603   2                      P2_0=1;
 604   2                      P2_4=1;
 605   2                      P4_4=1;
 606   2      
 607   2                      P3_0=0;
 608   2                      P3_5=0;
 609   2                      P2_1=0;
 610   2                      P2_5=0;
 611   2                      delay_1ms(yanshi);
 612   2                      key();
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 11  

 613   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 614   2                      P3_0=1;
 615   2                      P3_5=1;
 616   2                      P2_1=1;
 617   2                      P2_5=1;
 618   2      
 619   2                      P3_1=0;
 620   2                      P3_6=0;
 621   2                      P2_2=0;
 622   2                      P2_6=0;
 623   2                      delay_1ms(yanshi);
 624   2                      key();
 625   2                  if(ly_flag==1){moshi=0;ly_flag=0;break;}
 626   2                      P3_1=1;
 627   2                      P3_6=1;
 628   2                      P2_2=1;
 629   2                      P2_6=1;
 630   2      
 631   2                      P3_3=0;
 632   2                      P3_7=0;
 633   2                      P2_3=0;
 634   2                      P2_7=0;
 635   2                      delay_1ms(yanshi);
 636   2                      key();
 637   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 638   2                      P3_3=1;
 639   2                      P3_7=1;
 640   2                      P2_3=1;
 641   2                      P2_7=1;
 642   2      
 643   2                      P3_4=0;
 644   2                      P2_0=0;
 645   2                      P2_4=0;
 646   2                      P4_4=0;
 647   2                      delay_1ms(yanshi);
 648   2                      if(j<6)yanshi=yanshi-400;
 649   2                      key();
 650   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}
 651   2              }       
 652   1      }
 653          void dh7()
 654          {
 655   1              P3_0=0;//J1
 656   1              P3_1=0;//J2
 657   1              P3_3=0;//J3
 658   1              P3_4=0;//J4
 659   1              P3_5=0;//J5
 660   1              P3_6=0;//J6
 661   1              P3_7=0;//J7
 662   1              P2_0=0;//J8
 663   1              P2_1=0;//J9
 664   1              P2_2=0;//J10
 665   1              P2_3=0;//J11
 666   1              P2_4=0;//J12
 667   1              P2_5=0;//J13
 668   1              P2_6=0;//J14
 669   1              P2_7=0;//J15
 670   1              P4_4=0;//J16
 671   1              
 672   1              P1=0X00;
 673   1              P0=0X00;
 674   1              P4_6=0;
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 12  

 675   1      
 676   1              P1_7=1;
 677   1              delay_1ms(400);
 678   1              P1_6=1;
 679   1              delay_1ms(400);
 680   1              P1_6=0;
 681   1              P1_5=1;
 682   1              delay_1ms(400); 
 683   1              P1_5=0;
 684   1              P1_4=1;
 685   1              delay_1ms(400); 
 686   1              P1_4=0;
 687   1              P1_3=1;
 688   1              delay_1ms(400); 
 689   1              P1_3=0;
 690   1              P1_2=1;
 691   1              delay_1ms(400); 
 692   1              P1_2=0;
 693   1              P1_1=1;
 694   1              delay_1ms(400); 
 695   1              P1_1=0;
 696   1              P4_6=1;
 697   1              delay_1ms(400); 
 698   1              key();
 699   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 700   1              P4_6=0;
 701   1              P0_7=1;
 702   1              delay_1ms(400); 
 703   1              P0_7=0;
 704   1              P0_6=1;
 705   1              delay_1ms(400);
 706   1              P0_6=0;
 707   1              P0_5=1;
 708   1              delay_1ms(400); 
 709   1              P0_5=0;
 710   1              P0_4=1;
 711   1              delay_1ms(400); 
 712   1              P0_4=0;
 713   1              P0_3=1;
 714   1              delay_1ms(400); 
 715   1              P0_3=0;
 716   1              P0_2=1;
 717   1              delay_1ms(400); 
 718   1              P0_2=0;
 719   1              P0_1=1;
 720   1              delay_1ms(400);
 721   1              P0_1=0;
 722   1              P0_0=1;
 723   1              delay_1ms(400); /////////////P00
 724   1              key();
 725   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 726   1              P1_6=1;
 727   1              delay_1ms(400);
 728   1              P1_6=0;
 729   1              P1_5=1;
 730   1              delay_1ms(400); 
 731   1              P1_5=0;
 732   1              P1_4=1;
 733   1              delay_1ms(400); 
 734   1              P1_4=0;
 735   1              P1_3=1;
 736   1              delay_1ms(400); 
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 13  

 737   1              P1_3=0;
 738   1              P1_2=1;
 739   1              delay_1ms(400); 
 740   1              P1_2=0;
 741   1              P1_1=1;
 742   1              delay_1ms(400); 
 743   1              P1_1=0;
 744   1              P4_6=1;
 745   1              delay_1ms(400); 
 746   1              P4_6=0;
 747   1              P0_7=1;
 748   1              delay_1ms(400); 
 749   1              key();
 750   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 751   1              P0_7=0;
 752   1              P0_6=1;
 753   1              delay_1ms(400);
 754   1              P0_6=0;
 755   1              P0_5=1;
 756   1              delay_1ms(400); 
 757   1              P0_5=0;
 758   1              P0_4=1;
 759   1              delay_1ms(400); 
 760   1              P0_4=0;
 761   1              P0_3=1;
 762   1              delay_1ms(400); 
 763   1              P0_3=0;
 764   1              P0_2=1;
 765   1              delay_1ms(400); 
 766   1              P0_2=0;
 767   1              P0_1=1;
 768   1              delay_1ms(400);/////////////////////////////P01
 769   1              key();
 770   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 771   1              P1_6=1;
 772   1              delay_1ms(400);
 773   1              P1_6=0;
 774   1              P1_5=1;
 775   1              delay_1ms(400); 
 776   1              P1_5=0;
 777   1              P1_4=1;
 778   1              delay_1ms(400); 
 779   1              P1_4=0;
 780   1              P1_3=1;
 781   1              delay_1ms(400); 
 782   1              P1_3=0;
 783   1              P1_2=1;
 784   1              delay_1ms(400); 
 785   1              P1_2=0;
 786   1              P1_1=1;
 787   1              delay_1ms(400); 
 788   1              key();
 789   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 790   1              P1_1=0;
 791   1              P4_6=1;
 792   1              delay_1ms(400); 
 793   1              P4_6=0;
 794   1              P0_7=1;
 795   1              delay_1ms(400); 
 796   1              P0_7=0;
 797   1              P0_6=1;
 798   1              delay_1ms(400);
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 14  

 799   1              P0_6=0;
 800   1              P0_5=1;
 801   1              delay_1ms(400); 
 802   1              P0_5=0;
 803   1              P0_4=1;
 804   1              delay_1ms(400); 
 805   1              P0_4=0;
 806   1              P0_3=1;
 807   1              delay_1ms(400); 
 808   1              key();
 809   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 810   1              P0_3=0;
 811   1              P0_2=1;
 812   1              delay_1ms(400);/////////////////////////////////P02
 813   1              P1_6=1;
 814   1              delay_1ms(400);
 815   1              P1_6=0;
 816   1              P1_5=1;
 817   1              delay_1ms(400); 
 818   1              P1_5=0;
 819   1              P1_4=1;
 820   1              delay_1ms(400); 
 821   1              P1_4=0;
 822   1              P1_3=1;
 823   1              delay_1ms(400); 
 824   1              P1_3=0;
 825   1              P1_2=1;
 826   1              delay_1ms(400); 
 827   1              P1_2=0;
 828   1              P1_1=1;
 829   1              delay_1ms(400); 
 830   1              key();
 831   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 832   1              P1_1=0;
 833   1              P4_6=1;
 834   1              delay_1ms(400); 
 835   1              P4_6=0;
 836   1              P0_7=1;
 837   1              delay_1ms(400); 
 838   1              P0_7=0;
 839   1              P0_6=1;
 840   1              delay_1ms(400);
 841   1              P0_6=0;
 842   1              P0_5=1;
 843   1              delay_1ms(400); 
 844   1              P0_5=0;
 845   1              P0_4=1;
 846   1              delay_1ms(400); 
 847   1              P0_4=0;
 848   1              P0_3=1;
 849   1              delay_1ms(400);//////////////////////////P03
 850   1              key();
 851   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 852   1              P1_6=1;
 853   1              delay_1ms(400);
 854   1              P1_6=0;
 855   1              P1_5=1;
 856   1              delay_1ms(400); 
 857   1              
 858   1              P1_5=0;
 859   1              P1_4=1;
 860   1              delay_1ms(400); 
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 15  

 861   1              P1_4=0;
 862   1              P1_3=1;
 863   1              delay_1ms(400); 
 864   1              
 865   1              P1_3=0;
 866   1              P1_2=1;
 867   1              delay_1ms(400); 
 868   1              
 869   1              P1_2=0;
 870   1              P1_1=1;
 871   1              delay_1ms(400); 
 872   1              key();
 873   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 874   1              P1_1=0;
 875   1              P4_6=1;
 876   1              delay_1ms(400); 
 877   1              P4_6=0;
 878   1              P0_7=1;
 879   1              delay_1ms(400);         
 880   1              P0_7=0;
 881   1              P0_6=1;
 882   1              delay_1ms(400);
 883   1              P0_6=0;
 884   1              P0_5=1;
 885   1              delay_1ms(400); 
 886   1              P0_5=0;
 887   1              P0_4=1;
 888   1              delay_1ms(400);///////////////////////////P04
 889   1              P1_6=1;
 890   1              delay_1ms(400);
 891   1              key();
 892   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 893   1              P1_6=0;
 894   1              P1_5=1;
 895   1              delay_1ms(400); 
 896   1              
 897   1              P1_5=0;
 898   1              P1_4=1;
 899   1              delay_1ms(400); 
 900   1              
 901   1              P1_4=0;
 902   1              P1_3=1;
 903   1              delay_1ms(400); 
 904   1      
 905   1              P1_3=0;
 906   1              P1_2=1;
 907   1              delay_1ms(400); 
 908   1              key();
 909   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}      
 910   1              P1_2=0;
 911   1              P1_1=1;
 912   1              delay_1ms(400); 
 913   1              
 914   1              P1_1=0;
 915   1              P4_6=1;
 916   1              delay_1ms(400); 
 917   1              P4_6=0;
 918   1              P0_7=1;
 919   1              delay_1ms(400); 
 920   1              
 921   1              P0_7=0;
 922   1              P0_6=1;
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 16  

 923   1              delay_1ms(400);
 924   1              
 925   1              P0_6=0;
 926   1              P0_5=1;
 927   1              delay_1ms(400);//////////////////////////////////P05
 928   1              key();
 929   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 930   1              P1_6=1;
 931   1              delay_1ms(400);
 932   1      
 933   1              P1_6=0;
 934   1              P1_5=1;
 935   1              delay_1ms(400); 
 936   1              
 937   1              P1_5=0;
 938   1              P1_4=1;
 939   1              delay_1ms(400); 
 940   1      
 941   1              P1_4=0;
 942   1              P1_3=1;
 943   1              delay_1ms(400); 
 944   1              
 945   1              P1_3=0;
 946   1              P1_2=1;
 947   1              delay_1ms(400); 
 948   1              
 949   1              P1_2=0;
 950   1              P1_1=1;
 951   1              delay_1ms(400); 
 952   1              key();
 953   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 954   1              P1_1=0;
 955   1              P4_6=1;
 956   1              delay_1ms(400); 
 957   1      
 958   1              P4_6=0;
 959   1              P0_7=1;
 960   1              delay_1ms(400); 
 961   1              
 962   1              P0_7=0;
 963   1              P0_6=1;
 964   1              delay_1ms(400); ///////////////////P06
 965   1              P1_6=1;
 966   1              delay_1ms(400);
 967   1      
 968   1              P1_6=0;
 969   1              P1_5=1;
 970   1              delay_1ms(400); 
 971   1              
 972   1              P1_5=0;
 973   1              P1_4=1;
 974   1              delay_1ms(400); 
 975   1              key();
 976   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
 977   1              P1_4=0;
 978   1              P1_3=1;
 979   1              delay_1ms(400); 
 980   1              
 981   1              P1_3=0;
 982   1              P1_2=1;
 983   1              delay_1ms(400); 
 984   1              
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 17  

 985   1              P1_2=0;
 986   1              P1_1=1;
 987   1              delay_1ms(400); 
 988   1      
 989   1              P1_1=0;
 990   1              P4_6=1;
 991   1              delay_1ms(400); 
 992   1      
 993   1              P4_6=0;
 994   1              P0_7=1;
 995   1              delay_1ms(400);//////////////////////////////////////P07
 996   1      
 997   1              P1_6=1;
 998   1              delay_1ms(400);
 999   1              key();
1000   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1001   1              P1_6=0;
1002   1              P1_5=1;
1003   1              delay_1ms(400); 
1004   1              
1005   1              P1_5=0;
1006   1              P1_4=1;
1007   1              delay_1ms(400); 
1008   1              
1009   1              P1_4=0;
1010   1              P1_3=1;
1011   1              delay_1ms(400); 
1012   1      
1013   1              P1_3=0;
1014   1              P1_2=1;
1015   1              delay_1ms(400); 
1016   1              
1017   1              P1_2=0;
1018   1              P1_1=1;
1019   1              delay_1ms(400); 
1020   1              
1021   1              P1_1=0;
1022   1              P4_6=1;
1023   1              delay_1ms(400); ///////////////////////////P46
1024   1              key();
1025   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1026   1              P1_6=1;
1027   1              delay_1ms(400);
1028   1      
1029   1              P1_6=0;
1030   1              P1_5=1;
1031   1              delay_1ms(400); 
1032   1              
1033   1              P1_5=0;
1034   1              P1_4=1;
1035   1              delay_1ms(400); 
1036   1      
1037   1              P1_4=0;
1038   1              P1_3=1;
1039   1              delay_1ms(400); 
1040   1              
1041   1              P1_3=0;
1042   1              P1_2=1;
1043   1              delay_1ms(400); 
1044   1              
1045   1              P1_2=0;
1046   1              P1_1=1;
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 18  

1047   1              delay_1ms(400); ///////////////////////////////////
1048   1              key();
1049   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1050   1              P1_6=1;
1051   1              delay_1ms(400);
1052   1      
1053   1              P1_6=0;
1054   1              P1_5=1;
1055   1              delay_1ms(400); 
1056   1              
1057   1              P1_5=0;
1058   1              P1_4=1;
1059   1              delay_1ms(400); 
1060   1      
1061   1              P1_4=0;
1062   1              P1_3=1;
1063   1              delay_1ms(400); 
1064   1              
1065   1              P1_3=0;
1066   1              P1_2=1;
1067   1              delay_1ms(400); ///////////////////////////////////////////
1068   1      
1069   1              P1_6=1;
1070   1              delay_1ms(400);
1071   1              key();
1072   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1073   1              P1_6=0;
1074   1              P1_5=1;
1075   1              delay_1ms(400); 
1076   1              
1077   1              P1_5=0;
1078   1              P1_4=1;
1079   1              delay_1ms(400); 
1080   1              
1081   1              P1_4=0;
1082   1              P1_3=1;
1083   1              delay_1ms(400);/////////////////////////////////////
1084   1      
1085   1              P1_6=1;
1086   1              delay_1ms(400);
1087   1      
1088   1              P1_6=0;
1089   1              P1_5=1;
1090   1              delay_1ms(400); 
1091   1              
1092   1              P1_5=0;
1093   1              P1_4=1;
1094   1              delay_1ms(400);///////////////////////////////////
1095   1              key();
1096   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1097   1              P1_6=1;
1098   1              delay_1ms(400);
1099   1      
1100   1              P1_6=0;
1101   1              P1_5=1;
1102   1              delay_1ms(400); //////////////////////
1103   1      
1104   1              P1_6=1;
1105   1              delay_1ms(400); /////////////////////
1106   1      hm: ;                                                                                                                                                   
1107   1      }
1108          void dh8()
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 19  

1109          {
1110   1              P3_0=0;//J1
1111   1              P3_1=0;//J2
1112   1              P3_3=0;//J3
1113   1              P3_4=0;//J4
1114   1              P3_5=0;//J5
1115   1              P3_6=0;//J6
1116   1              P3_7=0;//J7
1117   1              P2_0=0;//J8
1118   1              P2_1=0;//J9
1119   1              P2_2=0;//J10
1120   1              P2_3=0;//J11
1121   1              P2_4=0;//J12
1122   1              P2_5=0;//J13
1123   1              P2_6=0;//J14
1124   1              P2_7=0;//J15
1125   1              P4_4=0;//J16
1126   1      
1127   1              P1_7=1;
1128   1              P1_6=1;
1129   1              P1_5=1;
1130   1              P1_4=1;
1131   1              P1_3=1;
1132   1              P1_2=1;
1133   1              P1_1=1;
1134   1              P4_6=1;
1135   1              P0_7=1;
1136   1              P0_6=1;
1137   1              P0_5=1;
1138   1              P0_4=1;
1139   1              P0_3=1;
1140   1              P0_2=1;
1141   1              P0_1=1;
1142   1              P0_1=1; 
1143   1              P0_0=1;
1144   1              delay_1ms(9000);
1145   1              key();
1146   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1147   1              delay_1ms(9000);
1148   1              key();
1149   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1150   1              delay_1ms(9000);
1151   1              key();
1152   1              if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1153   1              delay_1ms(9000);
1154   1      hm: ;
1155   1      }
1156          void dh9()
1157          {
1158   1              char i;
1159   1              P3_0=0;//J1
1160   1              P3_1=0;//J2
1161   1              P3_3=0;//J3
1162   1              P3_4=0;//J4
1163   1              P3_5=0;//J5
1164   1              P3_6=0;//J6
1165   1              P3_7=0;//J7
1166   1              P2_0=0;//J8
1167   1              P2_1=0;//J9
1168   1              P2_2=0;//J10
1169   1              P2_3=0;//J11
1170   1              P2_4=0;//J12
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 20  

1171   1              P2_5=0;//J13
1172   1              P2_6=0;//J14
1173   1              P2_7=0;//J15
1174   1              P4_4=0;//J16
1175   1              
1176   1              P1_7=0;
1177   1              P1_6=0;
1178   1              P1_5=0;
1179   1              P1_4=0;
1180   1              P1_3=0;
1181   1              P1_2=0;
1182   1              P1_1=0;
1183   1              P4_6=0;
1184   1              P0_7=0;
1185   1              P0_6=0;
1186   1              P0_5=0;
1187   1              P0_4=0;
1188   1              P0_3=0;
1189   1              P0_2=0;
1190   1              P0_1=0;
1191   1              P0_1=0; 
1192   1              P0_0=0; 
1193   1      
1194   1              for(i=0;i<5;i++)
1195   1              {
1196   2                      P1_4=0;
1197   2                      P1_3=0;
1198   2                      P0_4=0;
1199   2                      P0_3=0;
1200   2              
1201   2                      P1_7=1;
1202   2                      P4_6=1;
1203   2                      P0_7=1;
1204   2                      P0_0=1;
1205   2                      delay_1ms(1000);
1206   2      
1207   2                      P1_7=0;
1208   2                      P4_6=0;
1209   2                      P0_7=0;
1210   2                      P0_0=0;
1211   2              
1212   2                      P1_6=1;
1213   2                      P1_1=1;
1214   2                      P0_6=1;
1215   2                      P0_1=1;
1216   2                      delay_1ms(1000);
1217   2                      key();  
1218   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}        
1219   2                      P1_6=0;
1220   2                      P1_1=0;
1221   2                      P0_6=0;
1222   2                      P0_1=0;
1223   2              
1224   2                      P1_5=1;
1225   2                      P1_2=1;
1226   2                      P0_5=1;
1227   2                      P0_2=1;
1228   2                      delay_1ms(1000);        
1229   2              
1230   2                      P1_5=0;
1231   2                      P1_2=0;
1232   2                      P0_5=0;
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 21  

1233   2                      P0_2=0;
1234   2              
1235   2                      P1_4=1;
1236   2                      P1_3=1;
1237   2                      P0_4=1;
1238   2                      P0_3=1;
1239   2                      delay_1ms(1000);
1240   2                      key();
1241   2                      if(ly_flag==1){moshi=0;ly_flag=0;break;}        
1242   2              }                       
1243   1      }
1244          void dh10()
1245          {
1246   1              P3_0=0;//J1
1247   1              P3_1=0;//J2
1248   1              P3_3=0;//J3
1249   1              P3_4=0;//J4
1250   1              P3_5=0;//J5
1251   1              P3_6=0;//J6
1252   1              P3_7=0;//J7
1253   1              P2_0=0;//J8
1254   1              P2_1=0;//J9
1255   1              P2_2=0;//J10
1256   1              P2_3=0;//J11
1257   1              P2_4=0;//J12
1258   1              P2_5=0;//J13
1259   1              P2_6=0;//J14
1260   1              P2_7=0;//J15
1261   1              P4_4=0;//J16
1262   1      
1263   1              P1_7=1;
1264   1              P1_6=0;
1265   1              P1_5=1;
1266   1              P1_4=0;
1267   1              P1_3=1;
1268   1              P1_2=0;
1269   1              P1_1=1;
1270   1              P4_6=0;
1271   1              P0_7=1;
1272   1              P0_6=0;
1273   1              P0_5=1;
1274   1              P0_4=0;
1275   1              P0_3=1;
1276   1              P0_2=0;
1277   1              P0_1=1; 
1278   1              P0_0=0; 
1279   1              delay_1ms(9000);
1280   1              key();
1281   1                      if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1282   1              delay_1ms(9000);
1283   1              key();
1284   1                      if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1285   1              delay_1ms(9000);
1286   1              key();
1287   1                      if(ly_flag==1){moshi=0;ly_flag=0;goto hm;}
1288   1              delay_1ms(9000);
1289   1      hm: ;
1290   1      }
1291          uchar STC_ADC()            //！！根据数据手册写一个ad读取函数
1292          {                                                                                                
1293   1           uchar i;
1294   1           ADC_RES   = 0;
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 22  

1295   1           ADC_RESL  = 0;
1296   1               ADC_CONTR = BIN(10001000);
1297   1               i=3;
1298   1           while(i--);
1299   1           while (1)                      
1300   1           {
1301   2               if (ADC_CONTR & BIN(10000))       
1302   2               { 
1303   3                               break;
1304   3                       }
1305   2           }
1306   1           ADC_CONTR = BIN(10000000);
1307   1               return( ADC_RESL<<2) ;
1308   1      }
1309          uchar date;
1310          void init()
1311          {
1312   1          TMOD= 0x01;                            
1313   1          TL0 = (65536-50000)/256;        //设置定时初值
1314   1          TH0 = (65536-50000)%256;        //设置定时初值
1315   1          ET0 = 0;
1316   1          TR0 = 0;    
1317   1          EA = 1;
1318   1      }
1319          void pp()
1320          {
1321   1              if(date<=15 && date>0)
1322   1              {       
1323   2                      h=1;
1324   2                      if(v<h)
1325   2                      {
1326   3                              v=h;    
1327   3                              P0=0X01;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;
1328   3                      }
1329   2              }
1330   1      
1331   1              if(date<=30 && date>15)
1332   1              {       
1333   2                      h=2;
1334   2                      if(v<h)
1335   2                      {
1336   3                              v=h;    
1337   3                              P0=0X03;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;                
1338   3                      }
1339   2              }
1340   1              
1341   1              if(date<=45 && date>30)
1342   1              {
1343   2                      h=3;
1344   2                      if(v<h)
1345   2                      {
1346   3                              v=h;
1347   3                              P0=0X07;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;
1348   3                      }
1349   2              }
1350   1              if(date<=60 && date>45)
1351   1              {
1352   2                      h=4;
1353   2                      if(v<h)
1354   2                      {
1355   3                              v=h;
1356   3                              P0=0X0F;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 23  

1357   3                      }       
1358   2              }
1359   1              if(date<=75 && date>60)
1360   1              {
1361   2                      h=5;
1362   2                      if(v<h)
1363   2                      {
1364   3                              v=h;    
1365   3                              P0=0X1F;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;
1366   3                      }                       
1367   2              }
1368   1              if(date<=90 && date>75)
1369   1              {
1370   2                      h=6;
1371   2                      if(v<h)
1372   2                      {
1373   3                              v=h;    
1374   3                              P0=0X3F;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;        
1375   3                      }       
1376   2              }
1377   1              if(date<=105 && date>90)
1378   1              {
1379   2                      h=7;
1380   2                      if(v<h)
1381   2                      {
1382   3                              v=h;    
1383   3                              P0=0X7F;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;
1384   3                      }
1385   2              }
1386   1              if(date<=130 && date>105)
1387   1              {
1388   2                      h=8;
1389   2                      if(v<h)
1390   2                      {
1391   3                              v=h;    
1392   3                              P0=0XFF;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;
1393   3                      }
1394   2              }
1395   1              if(date<=145 && date>130)
1396   1              {
1397   2                      h=9;
1398   2                      if(v<h)
1399   2                      {
1400   3                              v=h;    
1401   3                              P0=0XFF;P4_6=1;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;                
1402   3                      }       
1403   2              }
1404   1              if(date<=160 && date>145)
1405   1              {
1406   2                      h=10;            
1407   2                      if(v<h)
1408   2                      {
1409   3                              v=h;
1410   3                              P0=0XFF;P4_6=1;P1_1=1;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;                                                
1411   3                      }               
1412   2              }
1413   1              if(date<=175 && date>160)
1414   1              {
1415   2                      h=11;
1416   2                      if(v<h)
1417   2                      {
1418   3                              v=h;    
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 24  

1419   3                              P0=0XFF;P4_6=1;P1_1=1;P1_2=1;P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;                
1420   3                      }
1421   2              }
1422   1              if(date<=190 && date>175)
1423   1              {
1424   2                      h=12;
1425   2                      if(v<h)
1426   2                      {
1427   3                              v=h;    
1428   3                              P0=0XFF;P4_6=1;P1_1=1;P1_2=1;P1_3=1;P1_7=0;P1_6=0;P1_5=0;P1_4=0;                        
1429   3                      }               
1430   2              }
1431   1              if(date<=205 && date>190)
1432   1              {
1433   2                      h=13;
1434   2                      if(v<h)
1435   2                      {
1436   3                              v=h;    
1437   3                              P0=0XFF;P4_6=1;P1_1=1;P1_2=1;P1_3=1;P1_4=1;P1_7=0;P1_6=0;P1_5=0;
1438   3                      }                       
1439   2              }
1440   1              if(date<=220 && date>205)
1441   1              {
1442   2                      h=14;
1443   2                      if(v<h)
1444   2                      {
1445   3                              v=h;    
1446   3                              P0=0XFF;P4_6=1;P1_1=1;P1_2=1;P1_3=1;P1_4=1;P1_5=1;P1_7=0;P1_6=0;                
1447   3                      }       
1448   2              }
1449   1              if(date<=235 && date>220)
1450   1              {
1451   2                      h=15;
1452   2                      if(v<h)
1453   2                      {
1454   3                              v=h;    
1455   3                              P0=0XFF;P4_6=1;P1_1=1;P1_2=1;P1_3=1;P1_4=1;P1_5=1;P1_6=1;P1_7=0;
1456   3                      }                       
1457   2              }
1458   1              if(date>235)
1459   1              {
1460   2                      h=16;
1461   2                      if(v<h)
1462   2                      {
1463   3                              v=h;    
1464   3                              P0=0XFF;P4_6=1;P1_1=1;P1_2=1;P1_3=1;P1_4=1;P1_5=1;P1_6=1;P1_7=1;                        
1465   3                      }                               
1466   2              }
1467   1      }
1468          
1469          void sl()
1470          {
1471   1              P3_0=0;//J1
1472   1              P3_1=0;//J2
1473   1              P3_3=0;//J3
1474   1              P3_4=0;//J4
1475   1              P3_5=0;//J5
1476   1              P3_6=0;//J6
1477   1              P3_7=0;//J7
1478   1              P2_0=0;//J8
1479   1              P2_1=0;//J9
1480   1              P2_2=0;//J10
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 25  

1481   1              P2_3=0;//J11
1482   1              P2_4=0;//J12
1483   1              P2_5=0;//J13
1484   1              P2_6=0;//J14
1485   1              P2_7=0;//J15
1486   1              P4_4=0;//J16
1487   1      }
1488          
1489          void main()
1490          {
1491   1              P4SW =0Xff;
1492   1      
1493   1              P4M0=0xef;//  BIN(11111111);//P2组设置为推挽输出
1494   1              P4M1=0x00;      
1495   1      
1496   1              P1M0=0xff;
1497   1              P1M1=0x00;
1498   1              P1ASF =1;          //设置P1.0为AD口
1499   1          AUXR1 =BIN(100);
1500   1              init();
1501   1      
1502   1              P0M0=0xff;
1503   1              P0M1=0x00;
1504   1              
1505   1              while(1)
1506   1              {
1507   2                      if(moshi==1)dh1();
1508   2                      if(moshi==1)dh2();
1509   2                      if(moshi==1)dh3();
1510   2                      if(moshi==1)dh4();
1511   2                      if(moshi==1)dh5();
1512   2                      if(moshi==1)dh6();
1513   2                      if(moshi==1)dh7();
1514   2                      if(moshi==1)dh8();
1515   2                      if(moshi==1)dh9();
1516   2                      if(moshi==1)dh10();
1517   2              
1518   2                      if(moshi==0)
1519   2                      {
1520   3                              sl();
1521   3                              key();
1522   3                              date=STC_ADC();
1523   3                              pp();
1524   3                              delay_1ms(2);                   
1525   3                      }
1526   2              }
1527   1      }
1528          
1529          void InitTimer0() interrupt 1  // 1毫秒@11.0592MHz
1530          {
1531   1          TL0 = (65536-10000)/256;        //设置定时初值
1532   1          TH0 = (65536-10000)%256;        //设置定时初值
1533   1              t++;
1534   1              if(t==3)
1535   1              {
1536   2                      t=0;
1537   2                      if(v==0);
1538   2                      else v--;
1539   2      
1540   2                      if(v==16){P1_7=1;}      
1541   2                      if(v==15){P1_7=0;}      
1542   2                      if(v==14){P1_7=0;P1_6=0;}       
C51 COMPILER V9.00   MAIN                                                                  06/27/2016 21:22:05 PAGE 26  

1543   2                      if(v==13){P1_7=0;P1_6=0;P1_5=0;}
1544   2                      if(v==12){P1_7=0;P1_6=0;P1_5=0;P1_4=0;} 
1545   2                      if(v==11){P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;}  
1546   2                      if(v==10){P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;}   
1547   2                      if(v==9) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;}    
1548   2                      if(v==8) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;}     
1549   2                      if(v==7) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;P0=0X7F;}//   
1550   2                      if(v==6) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;P0=0X3F;}//           
1551   2                      if(v==5) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;P0=0X1F;}//   
1552   2                      if(v==4) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;P0=0X0F;}//   
1553   2                      if(v==3) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;P0=0X07;}//
1554   2                      if(v==2) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;P0=0X03;}//           
1555   2                      if(v==1) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;P0=0X01;}//           
1556   2                      if(v==0) {P1_7=0;P1_6=0;P1_5=0;P1_4=0;P1_3=0;P1_2=0;P1_1=0;P4_6=0;P0=0X00;}//           
1557   2              }                               
1558   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   4260    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
